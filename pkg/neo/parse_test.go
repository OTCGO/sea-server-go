package neo

import (
	"github.com/hzxiao/goutil/assert"
	"testing"
)

func TestContractInfo_parse(t *testing.T)  {
	c := &ContractInfo{}
	c.Script = `03687a630b383338323240612e636f6d02687a03312e3003687a6351550207104d970554c56b6c766b00527ac46c766b51527ac46168164e656f2e52756e74696d652e476574547269676765726338006114375e9fdf6aae590fed0758ba008b83e8ec22c17c6168184e656f2e52756e74696d652e436865636b5769746e657373616c75666168164e656f2e52756e74696d652e4765745472696767657260907c907c9e6309016c766b00c304696e697487640b0061652301616c75666c766b00c30b746f74616c537570706c7987640b0061652102616c75666c766b00c3046e616d6587640b006165c900616c75666c766b00c30673796d626f6c87640b006165c500616c75666c766b00c308646563696d616c7387640b006165b600616c75666c766b00c30962616c616e63654f66876422006c766b51c3c0519c63080000616c75666c766b51c300c36165e601616c75666c766b00c3087472616e7366657287644a006c766b51c3c0539c63080000616c75666c766b51c300c36c766b51c351c36c766b52527ac46c766b51c352c36c766b53527ac46c766b52c36c766b53c361527265cc01616c756600616c756600c56b0c485a204e656f20546f6b656e616c756600c56b03485a43616c756600c56b58616c756600c56b6168164e656f2e53746f726167652e476574436f6e746578740b746f74616c537570706c79617c680f4e656f2e53746f726167652e476574c064080000616c75666168164e656f2e53746f726167652e476574436f6e746578746114375e9fdf6aae590fed0758ba008b83e8ec22c17c070000c16ff2862361653f03615272680f4e656f2e53746f726167652e5075746168164e656f2e53746f726167652e476574436f6e746578740b746f74616c537570706c79070000c16ff28623615272680f4e656f2e53746f726167652e50757461006114375e9fdf6aae590fed0758ba008b83e8ec22c17c070000c16ff28623615272087472616e7366657254c168124e656f2e52756e74696d652e4e6f7469667951616c756600c56b6168164e656f2e53746f726167652e476574436f6e746578740b746f74616c537570706c79617c680f4e656f2e53746f726167652e476574616c756651c56b6c766b00527ac46168164e656f2e53746f726167652e476574436f6e746578746c766b00c3617c680f4e656f2e53746f726167652e476574616c756656c56b6c766b00527ac46c766b51527ac46c766b52527ac46c766b00c3c00114907c907c9e630f006c766b51c3c001149c63080000616c75666c766b52c300a164080000616c75666c766b00c36168184e656f2e52756e74696d652e436865636b5769746e65737363080000616c75666c766b00c36c766b51c3907c907c9e63080051616c75666168164e656f2e53746f726167652e476574436f6e746578746c766b00c3617c680f4e656f2e53746f726167652e47657461657c016c766b53527ac46c766b53c36c766b52c39f64080000616c75666168164e656f2e53746f726167652e476574436f6e746578746c766b51c3617c680f4e656f2e53746f726167652e47657461652d016c766b53c36c766b52c3946c766b54527ac46c766b52c3936c766b55527ac46c766b54c300a06441006168164e656f2e53746f726167652e476574436f6e746578746c766b00c36c766b54c36165ca00615272680f4e656f2e53746f726167652e5075746241006c766b54c3009c6437006168164e656f2e53746f726167652e476574436f6e746578746c766b00c3617c68124e656f2e53746f726167652e44656c6574656168164e656f2e53746f726167652e476574436f6e746578746c766b51c36c766b55c361654e00615272680f4e656f2e53746f726167652e507574616c766b00c36c766b51c36c766b52c3615272087472616e7366657254c168124e656f2e52756e74696d652e4e6f7469667951616c756651c56b6c766b00527ac46c766b00c3616c756651c56b6c766b00527ac46c766b00c3616c756668134e656f2e436f6e74726163742e437265617465`
	err := c.parse()
	assert.NoError(t, err)

	assert.Equal(t, "d52e51bc8f4ea51c6798a3d3e5a9a07b6253bf47", c.Contract)
	assert.Equal(t, "hzc", c.ContractName)
	assert.Equal(t, "1.0", c.Version)
	assert.Equal(t, []string{"String", "Array"}, c.Parameter)
	assert.Equal(t, "bytearray", c.ReturnType)
	assert.True(t, c.UseStorage)
	assert.False(t, c.DynamicCall)
	assert.Equal(t, "hz", c.Author)
	assert.Equal(t, "83822@a.com", c.Email)
	assert.Equal(t, "hzc", c.Description)

}